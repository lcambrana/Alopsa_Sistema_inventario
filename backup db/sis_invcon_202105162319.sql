--
-- Script was generated by Devart dbForge Studio 2020 for MySQL, Version 9.0.505.0
-- Product home page: http://www.devart.com/dbforge/mysql/studio
-- Script date 16/05/2021 23:19:39
-- Server version: 10.4.18
-- Client version: 4.1
--

-- 
-- Disable foreign keys
-- 
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;

-- 
-- Set SQL mode
-- 
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;

-- 
-- Set character set the client will use to send SQL statements to the server
--
SET NAMES 'utf8';

--
-- Set default database
--
USE sis_invcon;

--
-- Drop table `bitacora`
--
DROP TABLE IF EXISTS bitacora;

--
-- Drop table `dfallatir`
--
DROP TABLE IF EXISTS dfallatir;

--
-- Drop table `tamaniochasis`
--
DROP TABLE IF EXISTS tamaniochasis;

--
-- Drop table `usuarios_activos`
--
DROP TABLE IF EXISTS usuarios_activos;

--
-- Drop table `vacios_flota`
--
DROP TABLE IF EXISTS vacios_flota;

--
-- Drop procedure `actualizar_tir`
--
DROP PROCEDURE IF EXISTS actualizar_tir;

--
-- Drop procedure `Cierre_Tir`
--
DROP PROCEDURE IF EXISTS Cierre_Tir;

--
-- Drop procedure `insert_tir`
--
DROP PROCEDURE IF EXISTS insert_tir;

--
-- Drop table `tipocontenedor`
--
DROP TABLE IF EXISTS tipocontenedor;

--
-- Drop table `usuario_permiso`
--
DROP TABLE IF EXISTS usuario_permiso;

--
-- Drop table `permiso`
--
DROP TABLE IF EXISTS permiso;

--
-- Drop procedure `actualizar_asign`
--
DROP PROCEDURE IF EXISTS actualizar_asign;

--
-- Drop procedure `actualizar_asignaciones`
--
DROP PROCEDURE IF EXISTS actualizar_asignaciones;

--
-- Drop procedure `insertar_asign`
--
DROP PROCEDURE IF EXISTS insertar_asign;

--
-- Drop procedure `listar_asignaciones`
--
DROP PROCEDURE IF EXISTS listar_asignaciones;

--
-- Drop procedure `mostrar_asignacion`
--
DROP PROCEDURE IF EXISTS mostrar_asignacion;

--
-- Drop table `asignaciones`
--
DROP TABLE IF EXISTS asignaciones;

--
-- Drop procedure `actualizar_conexion`
--
DROP PROCEDURE IF EXISTS actualizar_conexion;

--
-- Drop procedure `datosconexion`
--
DROP PROCEDURE IF EXISTS datosconexion;

--
-- Drop procedure `datosingreso`
--
DROP PROCEDURE IF EXISTS datosingreso;

--
-- Drop procedure `insertar_cone`
--
DROP PROCEDURE IF EXISTS insertar_cone;

--
-- Drop procedure `mostrar_conexiones`
--
DROP PROCEDURE IF EXISTS mostrar_conexiones;

--
-- Drop procedure `mostrar_dato_conexion`
--
DROP PROCEDURE IF EXISTS mostrar_dato_conexion;

--
-- Drop procedure `mostrar_desconexion`
--
DROP PROCEDURE IF EXISTS mostrar_desconexion;

--
-- Drop table `conexion`
--
DROP TABLE IF EXISTS conexion;

--
-- Drop table `contenedor_posicion_patio`
--
DROP TABLE IF EXISTS contenedor_posicion_patio;

--
-- Drop procedure `actualizar_fallastir`
--
DROP PROCEDURE IF EXISTS actualizar_fallastir;

--
-- Drop procedure `insert_fallastir`
--
DROP PROCEDURE IF EXISTS insert_fallastir;

--
-- Drop table `fallas_tir`
--
DROP TABLE IF EXISTS fallas_tir;

--
-- Drop procedure `mostrar_datos_tir`
--
DROP PROCEDURE IF EXISTS mostrar_datos_tir;

--
-- Drop procedure `mostrar_datostir`
--
DROP PROCEDURE IF EXISTS mostrar_datostir;

--
-- Drop table `datostir`
--
DROP TABLE IF EXISTS datostir;

--
-- Drop procedure `actualizar_desconexion`
--
DROP PROCEDURE IF EXISTS actualizar_desconexion;

--
-- Drop procedure `Insertar_desconexion`
--
DROP PROCEDURE IF EXISTS Insertar_desconexion;

--
-- Drop table `desconexion`
--
DROP TABLE IF EXISTS desconexion;

--
-- Drop table `envios`
--
DROP TABLE IF EXISTS envios;

--
-- Drop table `exportacion`
--
DROP TABLE IF EXISTS exportacion;

--
-- Drop procedure `actualizar_monitoreo`
--
DROP PROCEDURE IF EXISTS actualizar_monitoreo;

--
-- Drop procedure `insertar_monitoreo`
--
DROP PROCEDURE IF EXISTS insertar_monitoreo;

--
-- Drop procedure `listar_Monitoreo`
--
DROP PROCEDURE IF EXISTS listar_Monitoreo;

--
-- Drop procedure `mostrar_datos_monitoreo`
--
DROP PROCEDURE IF EXISTS mostrar_datos_monitoreo;

--
-- Drop table `monitoreo`
--
DROP TABLE IF EXISTS monitoreo;

--
-- Drop procedure `actualizar_ingreso_old`
--
DROP PROCEDURE IF EXISTS actualizar_ingreso_old;

--
-- Drop procedure `actualizar_ingresom`
--
DROP PROCEDURE IF EXISTS actualizar_ingresom;

--
-- Drop procedure `datosingreso_asig`
--
DROP PROCEDURE IF EXISTS datosingreso_asig;

--
-- Drop procedure `datosingreso_c`
--
DROP PROCEDURE IF EXISTS datosingreso_c;

--
-- Drop procedure `datosingreso_datostir`
--
DROP PROCEDURE IF EXISTS datosingreso_datostir;

--
-- Drop procedure `listardatosm`
--
DROP PROCEDURE IF EXISTS listardatosm;

--
-- Drop table `ingreso_maestro`
--
DROP TABLE IF EXISTS ingreso_maestro;

--
-- Drop table `vacios_despachos`
--
DROP TABLE IF EXISTS vacios_despachos;

--
-- Drop table `flota_transporte`
--
DROP TABLE IF EXISTS flota_transporte;

--
-- Drop table `movimientos`
--
DROP TABLE IF EXISTS movimientos;

--
-- Drop table `vacios_ingresos`
--
DROP TABLE IF EXISTS vacios_ingresos;

--
-- Drop table `usuarios`
--
DROP TABLE IF EXISTS usuarios;

--
-- Drop table `rol`
--
DROP TABLE IF EXISTS rol;

--
-- Drop table `altura_predio`
--
DROP TABLE IF EXISTS altura_predio;

--
-- Drop table `fila`
--
DROP TABLE IF EXISTS fila;

--
-- Drop table `bloque`
--
DROP TABLE IF EXISTS bloque;

--
-- Drop table `areas_patio`
--
DROP TABLE IF EXISTS areas_patio;

--
-- Drop table `patios`
--
DROP TABLE IF EXISTS patios;

--
-- Set default database
--
USE sis_invcon;

--
-- Create table `patios`
--
CREATE TABLE patios (
  id_patio INT(11) NOT NULL,
  patio_desc INT(11) DEFAULT NULL,
  PRIMARY KEY (id_patio)
)
ENGINE = INNODB,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_general_ci;

--
-- Create table `areas_patio`
--
CREATE TABLE areas_patio (
  id_area INT(11) NOT NULL AUTO_INCREMENT,
  area CHAR(5) DEFAULT NULL,
  id_patio INT(11) DEFAULT NULL,
  PRIMARY KEY (id_area)
)
ENGINE = INNODB,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_general_ci;

--
-- Create foreign key
--
ALTER TABLE areas_patio 
  ADD CONSTRAINT areas_patio_FK FOREIGN KEY (id_patio)
    REFERENCES patios(id_patio);

--
-- Create table `bloque`
--
CREATE TABLE bloque (
  id_bloque INT(11) NOT NULL AUTO_INCREMENT,
  Descripcion CHAR(20) DEFAULT NULL,
  id_area INT(11) DEFAULT NULL,
  PRIMARY KEY (id_bloque)
)
ENGINE = INNODB,
AUTO_INCREMENT = 4,
AVG_ROW_LENGTH = 5461,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_general_ci;

--
-- Create foreign key
--
ALTER TABLE bloque 
  ADD CONSTRAINT bloque_FK FOREIGN KEY (id_area)
    REFERENCES areas_patio(id_area);

--
-- Create table `fila`
--
CREATE TABLE fila (
  idfila INT(11) NOT NULL AUTO_INCREMENT,
  fila INT(11) DEFAULT NULL,
  estado CHAR(20) DEFAULT NULL,
  idbloque INT(11) DEFAULT NULL,
  id_ingreso INT(11) DEFAULT NULL,
  PRIMARY KEY (idfila)
)
ENGINE = INNODB,
AUTO_INCREMENT = 7,
AVG_ROW_LENGTH = 2730,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_general_ci;

--
-- Create foreign key
--
ALTER TABLE fila 
  ADD CONSTRAINT fila_FK FOREIGN KEY (idbloque)
    REFERENCES bloque(id_bloque);

--
-- Create table `altura_predio`
--
CREATE TABLE altura_predio (
  id_altura INT(11) NOT NULL AUTO_INCREMENT,
  altura INT(11) DEFAULT NULL,
  id_fila INT(11) DEFAULT NULL,
  PRIMARY KEY (id_altura)
)
ENGINE = INNODB,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_general_ci;

--
-- Create foreign key
--
ALTER TABLE altura_predio 
  ADD CONSTRAINT altura_predio_FK FOREIGN KEY (id_altura)
    REFERENCES fila(idfila);

--
-- Create table `rol`
--
CREATE TABLE rol (
  id_rol INT(11) NOT NULL AUTO_INCREMENT,
  descripcion CHAR(20) DEFAULT NULL,
  PRIMARY KEY (id_rol)
)
ENGINE = INNODB,
AUTO_INCREMENT = 4,
AVG_ROW_LENGTH = 8192,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_general_ci;

--
-- Create table `usuarios`
--
CREATE TABLE usuarios (
  id_usuario INT(11) NOT NULL AUTO_INCREMENT,
  nombre_usuario CHAR(20) DEFAULT NULL,
  usuario CHAR(20) DEFAULT NULL,
  clave VARCHAR(250) DEFAULT NULL,
  condicion INT(11) DEFAULT NULL,
  id_rol INT(11) DEFAULT NULL,
  imagen VARCHAR(50) DEFAULT NULL,
  email VARCHAR(75) DEFAULT NULL,
  departamento VARCHAR(50) DEFAULT NULL,
  empresa VARCHAR(75) DEFAULT NULL,
  PRIMARY KEY (id_usuario)
)
ENGINE = INNODB,
AUTO_INCREMENT = 4,
AVG_ROW_LENGTH = 8192,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_general_ci;

--
-- Create foreign key
--
ALTER TABLE usuarios 
  ADD CONSTRAINT usuario_rol FOREIGN KEY (id_rol)
    REFERENCES rol(id_rol);

--
-- Create table `vacios_ingresos`
--
CREATE TABLE vacios_ingresos (
  Id INT(11) NOT NULL AUTO_INCREMENT,
  Fecha_Ingreso DATE DEFAULT NULL,
  Hora_De_Ingreso DATETIME DEFAULT NULL,
  SZ CHAR(20) DEFAULT NULL,
  Dry_Reefer CHAR(20) DEFAULT NULL,
  Clasificacion CHAR(20) DEFAULT NULL,
  Contenido CHAR(20) DEFAULT NULL,
  Procedencia CHAR(20) DEFAULT NULL,
  TIR CHAR(20) DEFAULT NULL,
  HR_TIR CHAR(20) DEFAULT NULL,
  Transporte CHAR(20) DEFAULT NULL,
  Ubicacion CHAR(20) DEFAULT NULL,
  Estatus CHAR(20) DEFAULT NULL,
  Predio_From CHAR(20) DEFAULT NULL,
  Fecha DATE DEFAULT NULL,
  Sello_Export CHAR(20) DEFAULT NULL,
  Sello_Alopsa CHAR(20) DEFAULT NULL,
  Buque CHAR(20) DEFAULT NULL,
  ETA CHAR(20) DEFAULT NULL,
  Booking CHAR(20) DEFAULT NULL,
  Cliente CHAR(20) DEFAULT NULL,
  Producto CHAR(20) DEFAULT NULL,
  No_De_ATC CHAR(20) DEFAULT NULL,
  Peso_Tara CHAR(20) DEFAULT NULL,
  Fecha_Emision CHAR(20) DEFAULT NULL,
  Fecha_Vencimiento CHAR(20) DEFAULT NULL,
  Fecha_Actual CHAR(20) DEFAULT NULL,
  Dias_Estadia CHAR(20) DEFAULT NULL,
  Problemas_ATC CHAR(20) DEFAULT NULL,
  Forecast CHAR(20) DEFAULT NULL,
  Chatarra CHAR(20) DEFAULT NULL,
  Daños CHAR(20) DEFAULT NULL,
  Año_De_Fabricacion DATE DEFAULT NULL,
  id_usuario INT(11) NOT NULL,
  PRIMARY KEY (Id, id_usuario)
)
ENGINE = INNODB,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_general_ci;

--
-- Create foreign key
--
ALTER TABLE vacios_ingresos 
  ADD CONSTRAINT usuario_vacio_ingreso FOREIGN KEY (id_usuario)
    REFERENCES usuarios(id_usuario);

--
-- Create table `movimientos`
--
CREATE TABLE movimientos (
  Id_Movimientos INT(11) NOT NULL AUTO_INCREMENT,
  Semana CHAR(20) DEFAULT NULL,
  Año CHAR(20) DEFAULT NULL,
  Hora_Movimiento CHAR(10) DEFAULT NULL,
  Fecha_Movimeinto CHAR(20) DEFAULT NULL,
  Medida CHAR(20) DEFAULT NULL,
  No_Contenedor CHAR(20) DEFAULT NULL,
  Ingreso_Movimiento CHAR(10) DEFAULT NULL,
  Cliente CHAR(20) DEFAULT NULL,
  Actividad CHAR(20) DEFAULT NULL,
  Motivo CHAR(20) DEFAULT NULL,
  Despacho_Movimeinto CHAR(20) DEFAULT NULL,
  Importacion CHAR(20) DEFAULT NULL,
  Exportacion CHAR(20) DEFAULT NULL,
  Adicionales CHAR(20) DEFAULT NULL,
  Movimiento_Interno CHAR(20) DEFAULT NULL,
  Observaciones VARCHAR(75) DEFAULT NULL,
  Fecha_Movimiento DATE DEFAULT NULL,
  Horario_Turno CHAR(20) DEFAULT NULL,
  Kalmar_No CHAR(20) DEFAULT NULL,
  id_usuario INT(11) NOT NULL,
  PRIMARY KEY (Id_Movimientos, id_usuario)
)
ENGINE = INNODB,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_general_ci;

--
-- Create foreign key
--
ALTER TABLE movimientos 
  ADD CONSTRAINT mov_usuario FOREIGN KEY (id_usuario)
    REFERENCES usuarios(id_usuario);

--
-- Create table `flota_transporte`
--
CREATE TABLE flota_transporte (
  Id_f INT(11) NOT NULL AUTO_INCREMENT,
  Cabezal CHAR(20) DEFAULT NULL,
  Nombre_de_Piloto CHAR(20) DEFAULT NULL,
  Licencias CHAR(20) DEFAULT NULL,
  Placas CHAR(20) DEFAULT NULL,
  Codigo_Piloto_Naviera CHAR(20) DEFAULT NULL,
  Naviera CHAR(20) DEFAULT NULL,
  Creadopor CHAR(20) DEFAULT NULL,
  Estado INT(11) DEFAULT NULL,
  Fechacreacion DATE DEFAULT NULL,
  Transporte VARCHAR(20) DEFAULT NULL,
  Ubicacion CHAR(20) DEFAULT NULL,
  PRIMARY KEY (Id_f)
)
ENGINE = INNODB,
AUTO_INCREMENT = 4,
AVG_ROW_LENGTH = 8192,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_general_ci;

--
-- Create table `vacios_despachos`
--
CREATE TABLE vacios_despachos (
  Id_vd INT(11) NOT NULL AUTO_INCREMENT,
  Fecha_Despacho CHAR(20) DEFAULT NULL,
  Hora_De_Despacho CHAR(20) DEFAULT NULL,
  Marchamo CHAR(20) DEFAULT NULL,
  Digitador CHAR(20) DEFAULT NULL,
  Id_f INT(11) NOT NULL,
  Id INT(11) NOT NULL,
  id_usuario INT(11) NOT NULL,
  PRIMARY KEY (Id_vd)
)
ENGINE = INNODB,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_general_ci;

--
-- Create foreign key
--
ALTER TABLE vacios_despachos 
  ADD CONSTRAINT flota_vacio_d FOREIGN KEY (Id_f)
    REFERENCES flota_transporte(Id_f);

--
-- Create foreign key
--
ALTER TABLE vacios_despachos 
  ADD CONSTRAINT vacios_ingreso_despacho_v FOREIGN KEY (Id, id_usuario)
    REFERENCES vacios_ingresos(Id, id_usuario);

--
-- Create table `ingreso_maestro`
--
CREATE TABLE ingreso_maestro (
  Id_Ingreso INT(11) NOT NULL AUTO_INCREMENT,
  Fecha_ingreso DATE DEFAULT NULL,
  Hora_ingreso CHAR(20) DEFAULT NULL,
  No_Contenedor CHAR(20) DEFAULT NULL,
  Barco VARCHAR(50) DEFAULT NULL,
  Tipo_Contenido CHAR(20) DEFAULT NULL,
  Descripcion_contenido VARCHAR(50) DEFAULT NULL,
  Detalle_Servicio VARCHAR(20) DEFAULT NULL,
  Marchamo CHAR(20) DEFAULT NULL,
  Hora_TIR CHAR(10) DEFAULT NULL,
  Serie_TIR CHAR(5) DEFAULT NULL,
  producto VARCHAR(30) DEFAULT NULL,
  Ord INT(11) DEFAULT NULL,
  Bloque CHAR(20) DEFAULT NULL,
  Posicion INT(11) DEFAULT NULL,
  Observaciones CHAR(20) DEFAULT NULL,
  Destino CHAR(20) DEFAULT NULL,
  Fecha_Asignacion DATE DEFAULT NULL,
  tara DECIMAL(10, 2) DEFAULT NULL,
  Estado CHAR(20) DEFAULT NULL,
  Id_f INT(11) NOT NULL,
  id_usuario INT(11) NOT NULL,
  PRIMARY KEY (Id_Ingreso, Id_f, id_usuario),
  UNIQUE INDEX UK_ingreso_maestro(Id_Ingreso, id_usuario)
)
ENGINE = INNODB,
AUTO_INCREMENT = 6,
AVG_ROW_LENGTH = 4096,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_general_ci;

--
-- Create foreign key
--
ALTER TABLE ingreso_maestro 
  ADD CONSTRAINT flota_ingreso_m FOREIGN KEY (Id_f)
    REFERENCES flota_transporte(Id_f);

--
-- Create foreign key
--
ALTER TABLE ingreso_maestro 
  ADD CONSTRAINT usuario_maestro FOREIGN KEY (id_usuario)
    REFERENCES usuarios(id_usuario);

DELIMITER $$

--
-- Create procedure `listardatosm`
--
CREATE 
DEFINER = 'root'@'localhost'
PROCEDURE listardatosm()
BEGIN
SELECT
  a.Id_Ingreso,
  b.Nombre_de_Piloto,
  b.Placas,
  a.No_Contenedor,
  a.Marchamo,/*c.Descripcion Bloque,d.fila Posicion,*/
  a.producto,
  a.Barco,
  a.Destino,
  a.Estado,
  a.Bloque idb,
  a.Posicion idp,
  a.Id_f,
  a.tara,
  a.Descripcion_contenido
FROM ingreso_maestro a
  INNER JOIN flota_transporte b
    ON a.Id_f = b.Id_f

WHERE b.Estado = 1
AND a.Estado IN ('Ingresado', 'Anulado');
END
$$

--
-- Create procedure `datosingreso_datostir`
--
CREATE 
DEFINER = 'root'@'localhost'
PROCEDURE datosingreso_datostir(in idingreso int)
begin
SELECT
  a.Id_Ingreso,
  a.tara,
  b.Nombre_de_Piloto,
  b.Licencias,
  b.Placas,
  b.Codigo_Piloto_Naviera,
  a.No_Contenedor,
  b.Transporte,
  a.Destino,
  a.Id_f
FROM ingreso_maestro a
  INNER JOIN flota_transporte b
    ON b.Id_f = a.Id_f
WHERE a.Estado = 'Ingresado'
AND a.Id_Ingreso = idingreso;
END
$$

--
-- Create procedure `datosingreso_c`
--
CREATE 
DEFINER = 'root'@'localhost'
PROCEDURE datosingreso_c(in idingreso int)
BEGIN
SELECT
  a.Ord,
  a.producto,
  b.Descripcion,
  c.noposicion,
  a.Barco,
  a.Id_f
FROM ingreso_maestro a
  INNER JOIN bloque b
    ON a.Bloque = b.id_bloque
  INNER JOIN posicion c
    ON a.Posicion = c.idposicion
    AND a.Bloque = c.idbloque
WHERE a.Id_Ingreso = idingreso
AND a.Estado = 'ingresado';
END
$$

--
-- Create procedure `datosingreso_asig`
--
CREATE 
DEFINER = 'root'@'localhost'
PROCEDURE datosingreso_asig(in idingreso int)
BEGIN
SELECT
  a.Id_Ingreso,
  a.ord,
  b.Nombre_de_Piloto,
  b.Licencias,
  b.Placas,
  b.Codigo_Piloto_Naviera,
  a.No_Contenedor,
  a.Bloque,
  a.Posicion,
  a.producto,
  a.Barco,
  c.Descripcion,
  d.noposicion,
  a.Id_f
FROM ingreso_maestro a
  INNER JOIN flota_transporte b
    ON b.Id_f = a.Id_f
  INNER JOIN bloque c
    ON a.Bloque = c.id_bloque
  INNER JOIN posicion d
    ON a.Posicion = d.idposicion
WHERE a.Estado = 'Ingresado'
AND a.Id_Ingreso = idingreso;
END
$$

--
-- Create procedure `actualizar_ingresom`
--
CREATE 
DEFINER = 'root'@'localhost'
PROCEDURE actualizar_ingresom(IN `idingreso` INT, IN `fechaingreso` DATE,
IN `horaingreso` CHAR(20), IN `nocontenedor` CHAR(20), IN `barco` VARCHAR(50), IN `tipocontenido` CHAR(20),
IN `dcontenido` VARCHAR(20), IN `dservicio` VARCHAR(50), IN `destino` CHAR(20),IN `observaciones` VARCHAR(200),
IN `idf` INT, IN `idusuario` INT,in tara decimal(18,2))
BEGIN
 start transaction;
UPDATE ingreso_maestro
SET Fecha_ingreso = fechaingreso,
    Hora_ingreso = horaingreso,
    No_Contenedor = nocontenedor,
    Barco = barco,
    Tipo_Contenido = tipocontenido,
    Descripcion_contenido = dcontenido,
    Detalle_Servicio = dservicio,
    Observaciones = observaciones,
    Destino = destino,
    Estado = 'Ingresado',
    Id_f = idf,
    id_usuario = idusuario,
    tara = tara
WHERE Id_Ingreso = idingreso;
   
  if (@@error_count=0) then
	commit;
	else
	rollback;
end if;
commit;
 

  END
$$

--
-- Create procedure `actualizar_ingreso_old`
--
CREATE 
DEFINER = 'root'@'localhost'
PROCEDURE actualizar_ingreso_old(IN `idingreso` INT, IN `fechaingreso` DATE, IN `horaingreso` CHAR(20), IN `nocontenedor` CHAR(20), IN `barco` VARCHAR(50), IN `tipocontenido` CHAR(20), IN `dcontenido` VARCHAR(20), IN `dservicio` VARCHAR(50), IN `marchamo` CHAR(20), IN `htir` CHAR(10), IN `serietir` CHAR(5), IN `producto` VARCHAR(30), IN `orden` INT, IN `bloque` CHAR(20), IN `posicion` INT, IN `destino` CHAR(20), IN `fechaasignacion` DATE, IN `observaciones` VARCHAR(200), IN `idf` INT, IN `idusuario` INT)
BEGIN
  DECLARE posiciona int;
  DECLARE bloquea char(20);

SELECT
  Bloque,
  Posicion INTO bloquea, posiciona
FROM ingreso_maestro
WHERE Id_Ingreso = idingreso;
UPDATE posicion
SET id_ingreso = 0,
    estado = 'Sin Asignar'
WHERE id_ingreso = idingreso;

UPDATE ingreso_maestro
SET Fecha_ingreso = fechaingreso,
    Hora_ingreso = horaingreso,
    No_Contenedor = nocontenedor,
    Barco = barco,
    Tipo_Contenido = tipocontenido,
    Descripcion_contenido = dcontenido,
    Detalle_Servicio = dservicio,
    Marchamo = marchamo,
    Hora_TIR = htir,
    Serie_TIR = serietir,
    producto = producto,
    Ord = orden,
    Bloque = bloque,
    Posicion = posicion,
    Observaciones = observaciones,
    Destino = destino,
    Fecha_Asignacion = fechaasignacion,
    Estado = 'Ingresado',
    Id_f = idf,
    id_usuario = idusuario
WHERE Id_Ingreso = idingreso;

UPDATE posicion
SET id_ingreso = idingreso,
    estado = 'Asignado'
WHERE idPosicion = posicion
AND idbloque = bloque;

END
$$

DELIMITER ;

--
-- Create table `monitoreo`
--
CREATE TABLE monitoreo (
  Id_m INT(11) NOT NULL AUTO_INCREMENT,
  Hora_De_Monitoreo CHAR(10) DEFAULT NULL,
  Retorno DECIMAL(5, 2) DEFAULT NULL,
  Observaciones VARCHAR(50) DEFAULT NULL,
  Producto CHAR(20) DEFAULT NULL,
  Set_Point DECIMAL(5, 2) DEFAULT NULL,
  Suministro DECIMAL(5, 2) DEFAULT NULL,
  Fecha_Del_Monitoreo CHAR(20) DEFAULT NULL,
  Nombre_Del_Mecanico CHAR(20) DEFAULT NULL,
  id_ingreso INT(11) NOT NULL,
  Id_f INT(11) NOT NULL,
  id_usuario INT(11) NOT NULL,
  estado VARCHAR(10) DEFAULT NULL,
  temperatura CHAR(2) DEFAULT NULL,
  PRIMARY KEY (Id_m, id_ingreso, Id_f, id_usuario)
)
ENGINE = INNODB,
AUTO_INCREMENT = 3,
AVG_ROW_LENGTH = 8192,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_general_ci;

--
-- Create foreign key
--
ALTER TABLE monitoreo 
  ADD CONSTRAINT ingreso_m_monitoreo FOREIGN KEY (id_ingreso, id_usuario)
    REFERENCES ingreso_maestro(Id_Ingreso, id_usuario);

DELIMITER $$

--
-- Create procedure `mostrar_datos_monitoreo`
--
CREATE 
DEFINER = 'root'@'localhost'
PROCEDURE mostrar_datos_monitoreo(in idmonitoreo int)
BEGIN
SELECT
  *
FROM monitoreo
WHERE Id_m = idmonitoreo;
END
$$

--
-- Create procedure `listar_Monitoreo`
--
CREATE 
DEFINER = 'root'@'localhost'
PROCEDURE listar_Monitoreo()
BEGIN
SELECT
  a.Id_m,
  b.No_Contenedor,
  a.Hora_De_Monitoreo,
  a.Producto,
  a.Set_Point,
  a.Retorno,
  d.Descripcion Bloque,
  b.Posicion,
  b.Barco,
  a.Fecha_Del_Monitoreo
FROM monitoreo a
  INNER JOIN ingreso_maestro b
    ON a.Id_m = b.Id_Ingreso
  INNER JOIN flota_transporte c
    ON a.Id_f = c.Id_f
  INNER JOIN bloque d
    ON b.Bloque = d.id_bloque
WHERE a.estado = 'Activo';
END
$$

--
-- Create procedure `insertar_monitoreo`
--
CREATE 
DEFINER = 'root'@'localhost'
PROCEDURE insertar_monitoreo(in horamonitoreo char(10),
  in retorno varchar(30),in observaciones varchar(70),in producto char(20),
  in setpoint char(20),in suministro varchar(20),fechamonitoreo char(10),
  in mecanico char(20),in idingreso int,in idf int,in idusuarios int,in temperaura char(2))
BEGIN
start transaction;
INSERT INTO monitoreo (Hora_De_Monitoreo, Retorno, Observaciones, Producto,
Set_Point, Suministro, Fecha_Del_Monitoreo,
Nombre_Del_Mecanico, id_ingreso, Id_f, id_usuario, estado, temperatura)
  VALUES (horamonitoreo, retorno, observaciones, producto, setpoint, suministro, fechamonitoreo, mecanico, idingreso, idf, idusuarios, 'Activo', temperaura);
if (@@error_count=0) then
  commit;
  else
  rollback;
  end if;
commit;
END
$$

--
-- Create procedure `actualizar_monitoreo`
--
CREATE 
DEFINER = 'root'@'localhost'
PROCEDURE actualizar_monitoreo(in idmonitoreo int,
  in horamonitoreo char(10),in retorno varchar(30),in observaciones varchar(70),
  in producto char(20),in setpoint char(20),in suministro varchar(20),fechamonitoreo char(10),
  in mecanico char(20),in idingreso int,in idf int,in temperatura char(2))
BEGIN
  start transaction;

UPDATE monitoreo
SET Hora_De_Monitoreo = horamonitoreo,
    Retorno = retorno,
    Observaciones = observaciones,
    Producto = producto,
    Set_Point = setpoint,
    Suministro = suministro,
    Fecha_Del_Monitoreo = fechamonitoreo,
    Nombre_Del_Mecanico = mecanico,
    id_ingreso = idingreso,
    Id_f = idf,
    temperatura = temperatura
WHERE Id_m = idmonitoreo;

  if (@@error_count=0) then 
    commit;
    else
    rollback;
    end if;
commit;
END
$$

DELIMITER ;

--
-- Create table `exportacion`
--
CREATE TABLE exportacion (
  Id_e INT(11) NOT NULL AUTO_INCREMENT,
  Fecha_de_salida CHAR(20) DEFAULT NULL,
  Hora_de_Salida DATE DEFAULT NULL,
  id INT(11) NOT NULL,
  Id_f INT(11) NOT NULL,
  id_usuario INT(11) NOT NULL,
  PRIMARY KEY (Id_e, id, Id_f, id_usuario)
)
ENGINE = INNODB,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_general_ci;

--
-- Create foreign key
--
ALTER TABLE exportacion 
  ADD CONSTRAINT ingreso_m_export FOREIGN KEY (id, Id_f, id_usuario)
    REFERENCES ingreso_maestro(Id_Ingreso, Id_f, id_usuario);

--
-- Create table `envios`
--
CREATE TABLE envios (
  Id_en INT(11) NOT NULL AUTO_INCREMENT,
  No_Envio INT(11) DEFAULT NULL,
  Fecha_Envio DATE DEFAULT NULL,
  id INT(11) NOT NULL,
  Id_f INT(11) NOT NULL,
  id_usuario INT(11) NOT NULL,
  PRIMARY KEY (Id_en, id, Id_f, id_usuario)
)
ENGINE = INNODB,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_general_ci;

--
-- Create foreign key
--
ALTER TABLE envios 
  ADD CONSTRAINT ingreso_m_envio FOREIGN KEY (id, Id_f, id_usuario)
    REFERENCES ingreso_maestro(Id_Ingreso, Id_f, id_usuario);

--
-- Create table `desconexion`
--
CREATE TABLE desconexion (
  Id_d INT(11) NOT NULL AUTO_INCREMENT,
  Fecha_De_Desconexion DATE DEFAULT NULL,
  Hora_De_Desconexio CHAR(10) DEFAULT NULL,
  totalhoras CHAR(20) DEFAULT NULL,
  observaciones VARCHAR(75) DEFAULT NULL,
  id INT(11) NOT NULL,
  Id_f INT(11) NOT NULL,
  id_usuario INT(11) NOT NULL,
  estado CHAR(10) DEFAULT NULL,
  idconexion INT(11) DEFAULT NULL,
  PRIMARY KEY (Id_d, id, Id_f, id_usuario)
)
ENGINE = INNODB,
AUTO_INCREMENT = 2,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_general_ci;

--
-- Create foreign key
--
ALTER TABLE desconexion 
  ADD CONSTRAINT ingreso_m_desconexion FOREIGN KEY (id, Id_f, id_usuario)
    REFERENCES ingreso_maestro(Id_Ingreso, Id_f, id_usuario);

DELIMITER $$

--
-- Create procedure `Insertar_desconexion`
--
CREATE 
DEFINER = 'root'@'localhost'
PROCEDURE Insertar_desconexion(in fechadesco char(10),
  in horadesco char(10), in totalhoras char(10), in observaciones varchar(70),
  in idf int,in idingre int,in idusuario int,in idconexion int)
BEGIN
  	start transaction;
INSERT INTO desconexion (Fecha_De_Desconexion, Hora_De_Desconexio, totalhoras, observaciones, id, Id_f, id_usuario, estado, idconexion)
  VALUES (fechadesco, horadesco, totalhoras, observaciones, idingre, idf, idusuario, 'Activo', idconexion);
  if (@@error_count=0) then
	commit;
	else
	rollback;
end if;
commit;
END
$$

--
-- Create procedure `actualizar_desconexion`
--
CREATE 
DEFINER = 'root'@'localhost'
PROCEDURE actualizar_desconexion(in iddesco int,in fechadesco char(10),
  in horadesco char(10), in totalhoras char(10), in observaciones varchar(70),
  in idf int,in idingre int,in idconexion int)
BEGIN
  start transaction;
UPDATE desconexion
SET Fecha_De_Desconexion = fechadesco,
    Hora_De_Desconexio = horadesco,
    totalhoras = totalhoras,
    observaciones = observaciones,
    id = idingre,
    Id_f = idf,
    idconexion = idconexion
WHERE Id_d = iddesco;

  if (@@error_count=0) then
	commit;
	else
	rollback;
end if;
commit;

END
$$

DELIMITER ;

--
-- Create table `datostir`
--
CREATE TABLE datostir (
  idtir INT(11) NOT NULL AUTO_INCREMENT,
  SerieTir CHAR(2) DEFAULT NULL,
  chassis VARCHAR(10) DEFAULT NULL,
  tipochassis VARCHAR(5) DEFAULT NULL,
  refrigeracion VARCHAR(10) DEFAULT NULL,
  tipocontenedor VARCHAR(10) DEFAULT NULL,
  fecha VARCHAR(10) DEFAULT NULL,
  hora VARCHAR(10) DEFAULT NULL,
  tipomov VARCHAR(10) DEFAULT NULL,
  Nombre_naviera VARCHAR(30) NOT NULL,
  vacio VARCHAR(10) DEFAULT NULL,
  Destino VARCHAR(30) DEFAULT NULL,
  fallaizq BIT(1) DEFAULT NULL,
  fallader BIT(1) DEFAULT NULL,
  fallafre BIT(1) DEFAULT NULL,
  fallainte BIT(1) DEFAULT NULL,
  fallatra BIT(1) DEFAULT NULL,
  fallatec BIT(1) DEFAULT NULL,
  fallachas BIT(1) DEFAULT NULL,
  cliente VARCHAR(100) DEFAULT NULL,
  observaciones VARCHAR(200) DEFAULT NULL,
  Observaciones_cierre VARCHAR(100) DEFAULT NULL,
  booking INT(11) DEFAULT NULL,
  sello_botella VARCHAR(20) DEFAULT NULL,
  idingreso INT(11) DEFAULT NULL,
  id_f INT(11) DEFAULT NULL,
  id_usuario INT(11) DEFAULT NULL,
  estado VARCHAR(10) DEFAULT NULL,
  PRIMARY KEY (idtir),
  INDEX datortir_idtir_IDX(idtir)
)
ENGINE = INNODB,
AUTO_INCREMENT = 28,
AVG_ROW_LENGTH = 4681,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_general_ci;

--
-- Create foreign key
--
ALTER TABLE datostir 
  ADD CONSTRAINT datortir_FK FOREIGN KEY (idingreso, id_f, id_usuario)
    REFERENCES ingreso_maestro(Id_Ingreso, Id_f, id_usuario);

DELIMITER $$

--
-- Create procedure `mostrar_datostir`
--
CREATE 
DEFINER = 'root'@'localhost'
PROCEDURE mostrar_datostir()
begin
SELECT
  im.No_Contenedor,
  a.chassis,
  SerieTir,
  a.fecha,
  a.hora,
  ft.Transporte,
  ft.Nombre_de_Piloto,
  ft.Placas,
  a.Destino,
  a.vacio,
  a.cliente,
  a.idtir
FROM sis_invcon.datostir a
  INNER JOIN ingreso_maestro im
    ON a.idingreso = im.Id_Ingreso
  INNER JOIN flota_transporte ft
    ON a.id_f = ft.Id_f
WHERE a.estado = 'Activo';
END
$$

--
-- Create procedure `mostrar_datos_tir`
--
CREATE 
DEFINER = 'root'@'localhost'
PROCEDURE mostrar_datos_tir(in id_tir int)
begin
SELECT
  *
FROM sis_invcon.datostir
WHERE idtir = id_tir;
END
$$

DELIMITER ;

--
-- Create table `fallas_tir`
--
CREATE TABLE fallas_tir (
  idfalla_tir INT(11) NOT NULL AUTO_INCREMENT,
  id_datostir INT(11) DEFAULT NULL,
  ubicacion CHAR(20) DEFAULT NULL,
  falla VARCHAR(20) DEFAULT NULL,
  opcionfalla BIT(1) DEFAULT NULL,
  Posicion VARCHAR(10) DEFAULT NULL,
  observacion VARCHAR(50) DEFAULT NULL,
  PRIMARY KEY (idfalla_tir)
)
ENGINE = INNODB,
AUTO_INCREMENT = 29,
AVG_ROW_LENGTH = 1820,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_general_ci;

--
-- Create foreign key
--
ALTER TABLE fallas_tir 
  ADD CONSTRAINT Fallas_TIR_FK FOREIGN KEY (id_datostir)
    REFERENCES datostir(idtir);

DELIMITER $$

--
-- Create procedure `insert_fallastir`
--
CREATE 
DEFINER = 'root'@'localhost'
PROCEDURE insert_fallastir(in iddtir int,in ubicacion char(50),in f char(20),in op bit,in obser varchar(50),in pos varchar(10) )
begin
	start transaction;

INSERT INTO sis_invcon.fallas_tir (id_datostir, ubicacion, falla, opcionfalla, observacion, Posicion)
  VALUES (iddtir, ubicacion, f, op, obser, pos);

if (@@error_count=0) then
	commit;
	else
	rollback;
end if;
commit;
END
$$

--
-- Create procedure `actualizar_fallastir`
--
CREATE 
DEFINER = 'root'@'localhost'
PROCEDURE actualizar_fallastir(in idfat int,in id_ing int
,in ubicacion char(50),in f char(20),in op bit,in obser varchar(50),in pos varchar(10))
begin
	start transaction;
UPDATE sis_invcon.fallas_tir
SET ubicacion = ubicacion,
    falla = f,
    opcionfalla = op,
    Posicion = pos,
    observacion = obser
WHERE idfalla_tir = idfat
AND id_datostir = id_ing;

	if (@@error_count=0) then
	commit;
	else
	rollback;
end if;
commit;
END
$$

DELIMITER ;

--
-- Create table `contenedor_posicion_patio`
--
CREATE TABLE contenedor_posicion_patio (
  id_conte_posi INT(11) NOT NULL AUTO_INCREMENT,
  idpatio INT(11) DEFAULT NULL,
  idarea INT(11) DEFAULT NULL,
  idbloque INT(11) DEFAULT NULL,
  idfila INT(11) DEFAULT NULL,
  altura INT(11) DEFAULT NULL,
  idusuario INT(11) DEFAULT NULL,
  fecha VARCHAR(10) DEFAULT NULL,
  hora VARCHAR(10) DEFAULT NULL,
  id_ingre_m INT(11) DEFAULT NULL,
  idf INT(11) DEFAULT NULL,
  PRIMARY KEY (id_conte_posi)
)
ENGINE = INNODB,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_general_ci;

--
-- Create index `contenedor_posicion_patio_FK_1` on table `contenedor_posicion_patio`
--
ALTER TABLE contenedor_posicion_patio 
  ADD INDEX contenedor_posicion_patio_FK_1(idpatio);

--
-- Create foreign key
--
ALTER TABLE contenedor_posicion_patio 
  ADD CONSTRAINT contenedor_posicion_patio_FK FOREIGN KEY (id_ingre_m, idf, idusuario)
    REFERENCES ingreso_maestro(Id_Ingreso, Id_f, id_usuario);

--
-- Create foreign key
--
ALTER TABLE contenedor_posicion_patio 
  ADD CONSTRAINT contenedor_posicion_patio_FK_2 FOREIGN KEY (idfila)
    REFERENCES fila(idfila);

--
-- Create table `conexion`
--
CREATE TABLE conexion (
  Id INT(11) NOT NULL AUTO_INCREMENT,
  Fecha_Conexion DATE DEFAULT NULL,
  Hora_De_Conexion CHAR(10) DEFAULT NULL,
  Setpoint DECIMAL(5, 2) DEFAULT NULL,
  Suministro DECIMAL(5, 2) DEFAULT NULL,
  Retorno DECIMAL(5, 2) DEFAULT NULL,
  Id_ingreso INT(11) NOT NULL,
  Id_f INT(11) NOT NULL,
  Id_usuario INT(11) NOT NULL,
  Estado CHAR(10) DEFAULT NULL,
  temperatura CHAR(2) DEFAULT NULL,
  tipoconexion VARCHAR(2) DEFAULT NULL,
  PRIMARY KEY (Id, Id_ingreso, Id_f, Id_usuario)
)
ENGINE = INNODB,
AUTO_INCREMENT = 3,
AVG_ROW_LENGTH = 8192,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_general_ci;

--
-- Create foreign key
--
ALTER TABLE conexion 
  ADD CONSTRAINT ingreso_m_conexion FOREIGN KEY (Id_ingreso, Id_usuario)
    REFERENCES ingreso_maestro(Id_Ingreso, id_usuario);

DELIMITER $$

--
-- Create procedure `mostrar_desconexion`
--
CREATE 
DEFINER = 'root'@'localhost'
PROCEDURE mostrar_desconexion()
BEGIN
SELECT
  a.Fecha_De_Desconexion,
  a.Hora_De_Desconexio,
  a.totalhoras,
  b.Id_Ingreso,
  c.Cabezal,
  c.Nombre_de_Piloto,
  b.No_Contenedor,
  a.Id_d,
  b.Hora_ingreso,
  b.Fecha_ingreso,
  b.Descripcion_contenido,
  d.Id 'idco'
FROM desconexion a
  INNER JOIN ingreso_maestro b
    ON a.id = b.Id_Ingreso
  INNER JOIN flota_transporte c
    ON a.Id_f = c.Id_f
  INNER JOIN conexion d
    ON a.idconexion = d.Id
WHERE a.estado = 'Activo'
AND b.Estado = 'Ingresado';
END
$$

--
-- Create procedure `mostrar_dato_conexion`
--
CREATE 
DEFINER = 'root'@'localhost'
PROCEDURE mostrar_dato_conexion(in idconexion int)
BEGIN
SELECT
  *
FROM conexion
WHERE Id = idconexion;
END
$$

--
-- Create procedure `mostrar_conexiones`
--
CREATE 
DEFINER = 'root'@'localhost'
PROCEDURE mostrar_conexiones()
BEGIN
SELECT
  a.Id,
  b.No_Contenedor,
  a.Fecha_Conexion,
  a.Hora_De_Conexion,
  a.Setpoint,
  a.Suministro,
  a.Retorno,
  b.Id_Ingreso,
  c.Cabezal,
  c.Nombre_de_Piloto
FROM conexion a
  INNER JOIN ingreso_maestro b
    ON a.Id_ingreso = b.Id_Ingreso
  INNER JOIN flota_transporte c
    ON a.Id_f = c.Id_f
WHERE b.Estado = 'Ingresado'
AND a.Estado = 'Activo';
END
$$

--
-- Create procedure `insertar_cone`
--
CREATE 
DEFINER = 'root'@'localhost'
PROCEDURE insertar_cone(in fechac char(10),in horacon char(10),
in setpoint decimal(5,2),in suministro decimal(5,2),in retorno decimal(5,2),
in idingreso int, in idf int,in idusuario int,in temperatura char(2),in tipocon char(2))
BEGIN
	start transaction;
INSERT INTO sis_invcon.conexion (Fecha_Conexion, Hora_De_Conexion, Setpoint, Suministro, Retorno,
Id_ingreso, Id_f, Id_usuario, Estado, temperatura, tipoconexion)
  VALUES (fechac, horacon, setpoint, suministro, retorno, idingreso, idf, idusuario, 'Activo', temperatura, tipocon);
if (@@error_count=0) then
	commit;
	else
	rollback;
end if;
commit;
END
$$

--
-- Create procedure `datosingreso`
--
CREATE 
DEFINER = 'root'@'localhost'
PROCEDURE datosingreso(in idingreso int)
BEGIN
SELECT
  a.Ord,
  a.producto,
  b.Descripcion,
  c.noposicion,
  a.Barco,
  a.Id_f
FROM ingreso_maestro a
  INNER JOIN bloque b
    ON a.Bloque = b.id_bloque
  INNER JOIN posicion c
    ON a.Posicion = c.idposicion
    AND a.Bloque = c.idbloque
  INNER JOIN conexion d
    ON d.Id_ingreso = a.Id_Ingreso
WHERE d.Id = idingreso
AND a.Estado = 'ingresado';
END
$$

--
-- Create procedure `datosconexion`
--
CREATE 
DEFINER = 'root'@'localhost'
PROCEDURE datosconexion(in idconexion int)
BEGIN
SELECT
  a.Fecha_Conexion,
  a.Hora_De_Conexion,
  a.Setpoint,
  a.Suministro,
  b.Fecha_ingreso,
  b.Hora_ingreso,
  c.Cabezal,
  c.Nombre_de_Piloto,
  b.Id_f,
  b.Id_Ingreso
FROM conexion a
  INNER JOIN ingreso_maestro b
    ON a.Id_ingreso = b.Id_Ingreso
  INNER JOIN flota_transporte c
    ON b.Id_f = c.Id_f
WHERE a.id = idconexion;
END
$$

--
-- Create procedure `actualizar_conexion`
--
CREATE 
DEFINER = 'root'@'localhost'
PROCEDURE actualizar_conexion(in id_conexion int,in fechac char(10),in horacon char(10),
in setpoint decimal(5,2),in suministro decimal(5,2),in retorno decimal(5,2),
in idingreso int, in idf int,in temperatura char(2),in tipocon char(2))
BEGIN
  start transaction;

UPDATE conexion
SET Fecha_Conexion = fechac,
    Hora_De_Conexion = horacon,
    Setpoint = setpoint,
    Retorno = retorno,
    Suministro = suministro,
    Id_ingreso = idingreso,
    Id_f = Id_f,
    temperatura = temperatura,
    tipoconexion = tipocon
WHERE Id = id_conexion;

  if (@@error_count=0) then
	commit;
	else
	rollback;
end if;
commit;

END
$$

DELIMITER ;

--
-- Create table `asignaciones`
--
CREATE TABLE asignaciones (
  Id_a INT(11) NOT NULL AUTO_INCREMENT,
  observaciones VARCHAR(255) DEFAULT NULL,
  bloque INT(11) DEFAULT NULL,
  posicion INT(11) DEFAULT NULL,
  id INT(11) NOT NULL,
  Id_f INT(11) NOT NULL,
  id_usuario INT(11) NOT NULL,
  PRIMARY KEY (Id_a, id, Id_f, id_usuario)
)
ENGINE = INNODB,
AUTO_INCREMENT = 2,
AVG_ROW_LENGTH = 32768,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_general_ci;

--
-- Create foreign key
--
ALTER TABLE asignaciones 
  ADD CONSTRAINT ingreso_m_asignaciones FOREIGN KEY (id, Id_f, id_usuario)
    REFERENCES ingreso_maestro(Id_Ingreso, Id_f, id_usuario);

DELIMITER $$

--
-- Create procedure `mostrar_asignacion`
--
CREATE 
DEFINER = 'root'@'localhost'
PROCEDURE mostrar_asignacion(in idasignacion int)
begin

SELECT
  *
FROM sis_invcon.asignaciones
WHERE Id_a = idasignacion;
END
$$

--
-- Create procedure `listar_asignaciones`
--
CREATE 
DEFINER = 'root'@'localhost'
PROCEDURE listar_asignaciones()
BEGIN
SELECT
  b.Ord,
  a.Id_a,
  c.Nombre_de_Piloto,
  c.Placas,
  c.Codigo_Piloto_Naviera,
  b.No_Contenedor,
  d.Descripcion Bloque,
  e.noposicion Posicion,
  b.producto,
  b.Barco
FROM asignaciones a
  INNER JOIN ingreso_maestro b
    ON a.id = b.Id_Ingreso
  INNER JOIN flota_transporte c
    ON a.Id_f = c.Id_f
  INNER JOIN bloque d
    ON a.bloque = d.id_bloque
  INNER JOIN posicion e
    ON a.posicion = e.idposicion
WHERE b.Estado = 'Ingresado';
END
$$

--
-- Create procedure `insertar_asign`
--
CREATE 
DEFINER = 'root'@'localhost'
PROCEDURE insertar_asign(in observaciones varchar(255),
in bloque int,in posicion int,in idingreso int,in idf int,in idusuario int)
BEGIN
start transaction;
INSERT INTO asignaciones (observaciones, bloque, posicion, id, Id_f, id_usuario)
  VALUES (observaciones, bloque, posicion, idingreso, idf, idusuario);

UPDATE posicion
SET id_ingreso = idingreso,
    estado = 'Asignado'
WHERE idPosicion = posicion
AND idbloque = bloque;

if (@@error_count=0) then
	commit;
	else
	rollback;
end if;
commit;

END
$$

--
-- Create procedure `actualizar_asignaciones`
--
CREATE 
DEFINER = 'root'@'localhost'
PROCEDURE actualizar_asignaciones(in idasignacion int,in Observaciones varchar(255),in Bloque int,
in posiciona int,in idingresoa int,in idfa int)
begin
	 start transaction;
UPDATE sis_invcon.asignaciones
SET observaciones = Observaciones,
    bloque = Bloque,
    posicion = posiciona,
    id = idingresoa,
    Id_f = idfa
WHERE Id_a = idasignacion;

if (@@error_count=0) then
	commit;
	else
	rollback;
end if;
commit;

END
$$

--
-- Create procedure `actualizar_asign`
--
CREATE 
DEFINER = 'root'@'localhost'
PROCEDURE actualizar_asign(in idasignacion int, in observaciones varchar(255), in bloque int,in posicion int,
in idingreso int,in idf int)
begin
	start transaction;

UPDATE sis_invcon.asignaciones
SET observaciones = observaciones,
    bloque = bloque,
    posicion = posicion,
    id = idingreso,
    Id_f = idf
WHERE Id_a = idasignacion;

UPDATE sis_invcon.posicion
SET id_ingreso = idingreso,
    estado = 'Asignado'
WHERE idPosicion = posicion
AND idbloque = bloque;
		
if (@@error_count=0) then
	commit;
	else
	rollback;
end if;
commit;
END
$$

DELIMITER ;

--
-- Create table `permiso`
--
CREATE TABLE permiso (
  idpermiso INT(11) NOT NULL AUTO_INCREMENT,
  nombre VARCHAR(30) NOT NULL,
  PRIMARY KEY (idpermiso)
)
ENGINE = INNODB,
AUTO_INCREMENT = 8,
AVG_ROW_LENGTH = 5461,
CHARACTER SET utf8,
COLLATE utf8_general_ci;

--
-- Create table `usuario_permiso`
--
CREATE TABLE usuario_permiso (
  idusuario_permiso INT(11) NOT NULL AUTO_INCREMENT,
  idusuario INT(11) NOT NULL,
  idpermiso INT(11) NOT NULL,
  PRIMARY KEY (idusuario_permiso)
)
ENGINE = INNODB,
AUTO_INCREMENT = 28,
AVG_ROW_LENGTH = 1820,
CHARACTER SET utf8,
COLLATE utf8_general_ci;

--
-- Create index `fk_u_permiso_usuario_idx` on table `usuario_permiso`
--
ALTER TABLE usuario_permiso 
  ADD INDEX fk_u_permiso_usuario_idx(idusuario);

--
-- Create index `fk_usuario_permiso_idx` on table `usuario_permiso`
--
ALTER TABLE usuario_permiso 
  ADD INDEX fk_usuario_permiso_idx(idpermiso);

--
-- Create foreign key
--
ALTER TABLE usuario_permiso 
  ADD CONSTRAINT fk_u_permiso_usuario FOREIGN KEY (idusuario)
    REFERENCES usuarios(id_usuario) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Create foreign key
--
ALTER TABLE usuario_permiso 
  ADD CONSTRAINT fk_usuario_permiso FOREIGN KEY (idpermiso)
    REFERENCES permiso(idpermiso) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Create table `tipocontenedor`
--
CREATE TABLE tipocontenedor (
  id INT(11) NOT NULL AUTO_INCREMENT,
  descripcion VARCHAR(20) DEFAULT NULL,
  PRIMARY KEY (id)
)
ENGINE = INNODB,
AUTO_INCREMENT = 8,
AVG_ROW_LENGTH = 2340,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_general_ci;

DELIMITER $$

--
-- Create procedure `insert_tir`
--
CREATE 
DEFINER = 'root'@'localhost'
PROCEDURE insert_tir(in seriet char(2),in chasis char(10),
in tchasis varchar (5),in refrig varchar(10),in tconten varchar(10),in fechat char(10),
in horat char(10),in tmov char(10),in naviera varchar(30),in vacio varchar(10),in destino varchar(30),
in fizq bit,in fder bit,in ffre bit, in finte bit,in ftra bit,in ftec bit, in fcha bit,
in cli varchar(100), in obser varchar(200), in id_ingre int, in idf int,in idusuario int,
in booking int, in sbotella varchar(20))
begin
	start transaction;

INSERT INTO sis_invcon.datostir (SerieTir, chassis, tipochassis, refrigeracion, tipocontenedor, fecha, hora,
tipomov, Nombre_naviera, vacio, Destino, fallaizq, fallader, fallafre, fallainte,
fallatra, fallatec, fallachas, cliente, observaciones, idingreso, id_f, id_usuario, estado, booking, sello_botella)
  VALUES (seriet, chasis, tchasis, refrig, tconten, fechat, horat, tmov, naviera, vacio, destino, fizq, fder, ffre, finte, ftra, ftec, fcha, cli, obser, id_ingre, idf, idusuario, 'Activo', booking, sbotella);

SELECT
  LAST_INSERT_ID() AS idtir;
 if (@@error_count=0) then
	commit;
	
	else
	rollback;
end if;
commit;
END
$$

--
-- Create procedure `Cierre_Tir`
--
CREATE 
DEFINER = 'root'@'localhost'
PROCEDURE Cierre_Tir(in id_tir int, in observacionesc varchar(100),
in idusuario int, in fechac char(10),in horac char(10))
  DETERMINISTIC
  COMMENT 'Error al ejecutar el procedimiento'
begin
	
	declare exit handler for sqlexception
		begin
 
			rollback;
		end;
	declare exit handler for sqlwarning
	begin
		rollback;
	end;
	
	start transaction;
	
	set @obs := observacionesc;
	set @fechac :=fechac;
	set @horac :=horac;

INSERT INTO sis_invcon.datostir (SerieTir, chassis, tipochassis, refrigeracion, tipocontenedor,
fecha, hora, tipomov, Nombre_naviera, vacio, Destino, fallaizq, fallader, fallafre,
fallainte, fallatra, fallatec, fallachas, cliente, observaciones, Observaciones_cierre, idingreso, id_f, id_usuario, estado)
  SELECT
    SerieTir,
    chassis,
    tipochassis,
    refrigeracion,
    tipocontenedor,
    @fechac,
    @horac,
    'Salida',
    Nombre_naviera,
    vacio,
    Destino,
    fallaizq,
    fallader,
    fallafre,
    fallainte,
    fallatra,
    fallatec,
    fallachas,
    cliente,
    observaciones,
    @obs,
    idingreso,
    id_f,
    id_usuario,
    "Cerrado" estado
  FROM datostir d
  WHERE d.idtir = id_tir;

SELECT
  @idu := LAST_INSERT_ID();
INSERT INTO sis_invcon.fallas_tir (id_datostir, ubicacion, falla, opcionfalla, Posicion, observacion)
  SELECT
    @idu,
    ubicacion,
    falla,
    opcionfalla,
    Posicion,
    observacion
  FROM sis_invcon.fallas_tir
  WHERE id_datostir = id_tir;

UPDATE sis_invcon.datostir
SET estado = 'Cerrado'
WHERE idtir = id_tir;
commit;
END
$$

--
-- Create procedure `actualizar_tir`
--
CREATE 
DEFINER = 'root'@'localhost'
PROCEDURE actualizar_tir(in id_tir int,in seriet char(2),in chasis char(10),
in tchasis varchar (5),in refrig varchar(10),in tconten varchar(10),in fechat char(10),
in horat char(10),in tmov char(10),in naviera varchar(30),in vacio varchar(10),in destino varchar(30),
in fizq bit,in fder bit,in ffre bit, in finte bit,in ftra bit,in ftec bit, in fcha bit,
in cli varchar(100), in obser varchar(200), in id_ingre int, in idf int,
in booking int, in sbotella varchar(20))
begin
	start transaction;

UPDATE sis_invcon.datostir
SET SerieTir = seriet,
    chassis = chasis,
    tipochassis = tchasis,
    refrigeracion = refrig,
    tipocontenedor = tconten,
    fecha = fechat,
    hora = horat,
    tipomov = tmov,
    Nombre_naviera = naviera,
    vacio = vacio,
    Destino = destino,
    fallaizq = fizq,
    fallader = fder,
    fallafre = ffre,
    fallainte = finte,
    fallatra = ftra,
    fallatec = ftec,
    fallachas = fcha,
    cliente = cli,
    observaciones = obser,
    idingreso = id_ingre,
    id_f = idf,
    booking = booking,
    sello_botella = sbotella
WHERE idtir = id_tir;


SELECT
  id_tir AS idtir;
	if (@@error_count=0) then
	commit;
	else
	rollback;
end if;
commit;
END
$$

DELIMITER ;

--
-- Create table `vacios_flota`
--
CREATE TABLE vacios_flota (
  Id INT(11) NOT NULL AUTO_INCREMENT,
  Cabezal CHAR(20) DEFAULT NULL,
  Codigo_Cabezal CHAR(20) DEFAULT NULL,
  PRIMARY KEY (Id)
)
ENGINE = INNODB,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_general_ci;

--
-- Create table `usuarios_activos`
--
CREATE TABLE usuarios_activos (
  id INT(11) NOT NULL AUTO_INCREMENT,
  usuarios VARCHAR(10) DEFAULT NULL,
  nombre_usuario VARCHAR(50) DEFAULT NULL,
  fecha VARCHAR(10) DEFAULT NULL,
  hora VARCHAR(10) DEFAULT NULL,
  PRIMARY KEY (id)
)
ENGINE = INNODB,
AUTO_INCREMENT = 26,
AVG_ROW_LENGTH = 3276,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_general_ci;

--
-- Create table `tamaniochasis`
--
CREATE TABLE tamaniochasis (
  id INT(11) NOT NULL AUTO_INCREMENT,
  descripcion VARCHAR(10) DEFAULT NULL,
  PRIMARY KEY (id)
)
ENGINE = INNODB,
AUTO_INCREMENT = 5,
AVG_ROW_LENGTH = 4096,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_general_ci;

--
-- Create table `dfallatir`
--
CREATE TABLE dfallatir (
  id INT(11) NOT NULL AUTO_INCREMENT,
  utfalla VARCHAR(10) DEFAULT NULL,
  falla VARCHAR(20) DEFAULT NULL,
  PRIMARY KEY (id)
)
ENGINE = INNODB,
AUTO_INCREMENT = 28,
AVG_ROW_LENGTH = 630,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_general_ci;

--
-- Create table `bitacora`
--
CREATE TABLE bitacora (
  id INT(11) NOT NULL AUTO_INCREMENT,
  accion VARCHAR(20) DEFAULT NULL,
  fecha VARCHAR(10) DEFAULT NULL,
  hora VARCHAR(10) DEFAULT NULL,
  usuario VARCHAR(20) DEFAULT NULL,
  descripcion VARCHAR(100) DEFAULT NULL,
  tabla VARCHAR(10) DEFAULT NULL,
  PRIMARY KEY (id),
  INDEX bitacora_id_IDX(id)
)
ENGINE = INNODB,
AUTO_INCREMENT = 72,
AVG_ROW_LENGTH = 277,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_general_ci;

-- 
-- Dumping data for table patios
--
-- Table sis_invcon.patios does not contain any data (it is empty)

-- 
-- Dumping data for table rol
--
INSERT INTO rol VALUES
(1, 'Admin'),
(2, 'Usuario'),
(3, 'Supervisor');

-- 
-- Dumping data for table flota_transporte
--
INSERT INTO flota_transporte VALUES
(1, '122C', 'CRISTIAN ERNESTO GAR', '1928 08990 1804', 'C018BQH', '31748', 'MAERSK', 'Administrador', 1, '2021-03-30', 'MARK', 'PUERTO'),
(2, '117C', 'RONY DE JESUS HERRER', '2283 20143 1801', 'C007BQH', '30232', 'MAERSK', 'Administrador', 1, '2021-03-30', 'MARK', 'PUERTO'),
(3, 'C6', 'MARIO ESTUARDO MORAL', '2635 62298 1801', 'C899BPK', '40893', 'CHIQUITA', 'Administrador', 1, '2021-03-30', 'MARK', 'PUERTO');

-- 
-- Dumping data for table areas_patio
--
-- Table sis_invcon.areas_patio does not contain any data (it is empty)

-- 
-- Dumping data for table usuarios
--
INSERT INTO usuarios VALUES
(1, 'Administrador', 'admin', '8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918', 1, 1, '1614482617.png', 'sorporte@interport.com.gt', 'Informatica', 'ALOPSA'),
(2, 'Luis Cambran', 'lcambran', '908ac8d4a9cbab02e53685ca15fbaf46f63a06e2215257272d005da14858764c', 1, 3, '1617246834.png', 'luis@cambrantech.com', 'Informatica', 'ALOPSA'),
(3, 'Fredy Garcia', 'fgarcia', '8d969eef6ecad3c29a3a629280e686cf0c3f5d5a86aff3ca12020c923adc6c92', 1, 1, '1620397246.png', 'tecnicopb@interport.com.gt', 'Informatica', 'ALOPSA');

-- 
-- Dumping data for table ingreso_maestro
--
INSERT INTO ingreso_maestro VALUES
(1, '2021-03-31', '21:09:17', 'TEMU9080595', 'STARD STANDARD V49', 'VACIO', 'VACIO RF', 'VACIO', 'ALOPSA5490', '21:09:17', 'A', 'BANANO', 438, '2', 4, '0890021297/900020873', 'FINCAS', '2021-03-31', 450.20, 'Ingresado', 3, 1),
(2, '2021-04-01', '21:10:27', 'TEMU9080595', 'STARD STANDARD V49', 'VACIO', 'VACIO RF', 'VACIO', 'ALOPSA5490', '21:10:27', 'A', 'BANANO', 43, '1', 2, 'prueba de ingreso', 'FINCAS', '2021-04-01', NULL, 'Anulado', 1, 1),
(3, '2021-04-06', '18:00:37', 'TEMU9488308', 'STARD STANDARD V49', 'VACIO', 'VACIO RF', 'VACIO', 'ALOPSA5483', '18:00:37', 'A', 'SIN PRODUCTO', 9751, '2', 5, 'DESPACHO A FINCAS 2', 'FINCAS', '2021-04-06', 425.60, 'Ingresado', 3, 1),
(4, '2021-04-09', '14:59:13', 'TEMU9501349', 'STARD STANDARD V49', 'VACIO', 'VACIO RF', 'VACIO', 'ALOPSA5495', '14:59:13', 'A', 'BANANO', 11, '2', 6, 'DESPACHO A FINCAS', 'FINCAS', '2021-04-09', 255.25, 'Ingresado', 2, 1),
(5, '2021-05-14', '14:52:14', 'TEMU9488318', 'STARD STANDARD V50', 'VACIO', 'VACIO RC', 'VACIO', NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'Prueba de ingreso', 'GUATEMALA CIUDAD', NULL, 255.20, 'Ingresado', 3, 1);

-- 
-- Dumping data for table bloque
--
INSERT INTO bloque VALUES
(1, 'C1', NULL),
(2, 'C2', NULL),
(3, 'C3', NULL);

-- 
-- Dumping data for table vacios_ingresos
--
-- Table sis_invcon.vacios_ingresos does not contain any data (it is empty)

-- 
-- Dumping data for table permiso
--
INSERT INTO permiso VALUES
(1, 'dashboard'),
(2, 'acceso'),
(3, 'reportes'),
(4, 'Ingresoc'),
(5, 'Datosm'),
(6, 'ingresov'),
(7, 'ingresomov');

-- 
-- Dumping data for table datostir
--
INSERT INTO datostir VALUES
(1, 'A', 'DFS322', '20''', 'gens', '20', '2021-04-30', '22:21:53', 'Ingreso', 'MARK', 'si', 'FINCAS', True, True, False, False, True, False, False, 'Mark', 'Prueba de ingreso', NULL, 2132, 'test-2', 3, 3, 1, 'Activo'),
(2, 'A', '2232', '20''', 'gens', '40', '2021-05-03', '23:24:13', 'Ingreso', 'MARK', 'si', 'FINCAS', False, False, False, False, False, False, False, 'Mark', 'Generacion de Nuevo TIR', NULL, NULL, NULL, 4, 2, 1, 'Anulado'),
(3, 'A', '2232', '20''', 'gens', '40', '2021-05-03', '23:24:13', 'Ingreso', 'MARK', 'si', 'FINCAS', False, False, False, False, False, False, False, 'Mark', 'Generacion de Nuevo TIR', NULL, NULL, NULL, 4, 2, 1, 'Anulado'),
(4, 'A', 'F23', '20''', 'gens', '40', '2021-05-03', '23:24:13', 'Ingreso', 'MARK', 'si', 'FINCAS', True, True, False, False, True, False, False, 'Mark', 'Generacion de Nuevo TIR', NULL, NULL, NULL, 4, 2, 1, 'Cerrado'),
(22, 'A', 'F23', '20''', 'gens', '40', '2021/05/10', '23:52:54', 'Salida', 'MARK', 'si', 'FINCAS', True, True, False, False, True, False, False, 'Mark', 'Generacion de Nuevo TIR', 'prueba cierre', NULL, NULL, 4, 2, 1, 'Cerrado'),
(26, 'A', 'DFS3245', '40''', 'seco', '40', '2021-05-14', '15:20:13', 'Ingreso', 'MARK', 'si', 'GUATEMALA CIUDAD', True, True, False, False, False, False, False, 'm', 'prueba de ingresp', NULL, 365, 'Test-3', 5, 3, 1, 'Activo'),
(27, 'A', 'DFS3245', '40''', 'seco', '40', '2021/05/14', '15:31:25', 'Salida', 'MARK', 'si', 'GUATEMALA CIUDAD', True, True, False, False, False, False, False, 'm', 'prueba de ingresp', 'cierre de prueba', NULL, NULL, 5, 3, 1, 'Cerrado');

-- 
-- Dumping data for table fila
--
INSERT INTO fila VALUES
(1, 1, 'Sin Asignar', 1, 0),
(2, 2, 'Sin Asignar', 1, 0),
(3, 3, 'Sin Asignar', 1, 0),
(4, 1, 'Asignado', 2, 1),
(5, 2, 'Asignado', 2, 3),
(6, 3, 'Asignado', 2, 4);

-- 
-- Dumping data for table vacios_flota
--
-- Table sis_invcon.vacios_flota does not contain any data (it is empty)

-- 
-- Dumping data for table vacios_despachos
--
-- Table sis_invcon.vacios_despachos does not contain any data (it is empty)

-- 
-- Dumping data for table usuario_permiso
--
INSERT INTO usuario_permiso VALUES
(14, 1, 1),
(15, 1, 2),
(16, 1, 4),
(17, 1, 5),
(18, 1, 7),
(19, 2, 1),
(20, 2, 2),
(21, 2, 5),
(22, 2, 6),
(23, 3, 1),
(24, 3, 4),
(25, 3, 5),
(26, 3, 6),
(27, 3, 7);

-- 
-- Dumping data for table usuarios_activos
--
INSERT INTO usuarios_activos VALUES
(21, '1', 'Administrador', '2021-05-14', '15:54:59'),
(22, '1', 'Administrador', '2021-05-16', '20:04:30'),
(23, '1', 'Administrador', '2021-05-16', '20:34:48'),
(24, '1', 'Administrador', '2021-05-16', '20:37:36'),
(25, '1', 'Administrador', '2021-05-16', '20:39:27');

-- 
-- Dumping data for table tipocontenedor
--
INSERT INTO tipocontenedor VALUES
(1, '20 STD'),
(2, '40 STD'),
(3, '40 HC'),
(4, '45 HC'),
(5, 'FLAT RACK'),
(6, 'OPEN TOP'),
(7, 'ISO TANK');

-- 
-- Dumping data for table tamaniochasis
--
INSERT INTO tamaniochasis VALUES
(1, '20'''),
(2, '40'''),
(3, '40'' - 45'''),
(4, '45''');

-- 
-- Dumping data for table movimientos
--
-- Table sis_invcon.movimientos does not contain any data (it is empty)

-- 
-- Dumping data for table monitoreo
--
INSERT INTO monitoreo VALUES
(1, '22:42:02', 0.00, 'pruebas', 'BANANO', 23.00, 0.00, '2021-04-01', 'LUIS CAMBRAN', 1, 2, 1, 'Activo', 'F'),
(2, '15:16:12', 3.20, 'Prueba de ingreso', 'SIN PRODUCTO', 12.00, 1.00, '2021-04-09', 'CARLOS LOPEZ', 3, 3, 1, 'Activo', NULL);

-- 
-- Dumping data for table fallas_tir
--
INSERT INTO fallas_tir VALUES
(1, 1, 'Interior/Exterior', 'SUCIO', True, 'No Aplica', 'Sucio en la parte izquierda y derecha'),
(3, 2, 'Interior/Exterior', 'RAYADURA', True, 'No Aplica', 'Se encuentra rayado con marcador'),
(4, 3, 'Interior/Exterior', 'RAYADURA', True, 'No Aplica', 'Se encuentra rayado con marcador'),
(5, 4, 'Interior/Exterior', 'RAYADURA', True, 'No Aplica', 'Se encuentra rayado con marcador'),
(12, 4, 'Interior/Exterior', 'SUCIO', True, 'No Aplica', 'hg'),
(16, 22, 'Interior/Exterior', 'RAYADURA', True, 'No Aplica', 'Se encuentra rayado con marcador'),
(17, 22, 'Interior/Exterior', 'SUCIO', True, 'No Aplica', 'hg'),
(25, 26, 'Puertas', 'VISAGRAS', True, 'No Aplica', 'prueba visagras'),
(26, 26, 'Chasis', 'LUCES', True, 'No Aplica', 'luz'),
(27, 27, 'Puertas', 'VISAGRAS', True, 'No Aplica', 'prueba visagras'),
(28, 27, 'Chasis', 'LUCES', True, 'No Aplica', 'luz');

-- 
-- Dumping data for table exportacion
--
-- Table sis_invcon.exportacion does not contain any data (it is empty)

-- 
-- Dumping data for table envios
--
-- Table sis_invcon.envios does not contain any data (it is empty)

-- 
-- Dumping data for table dfallatir
--
INSERT INTO dfallatir VALUES
(1, 'int', 'SUCIO'),
(2, 'int', 'MAL OLOR'),
(3, 'int', 'RAYADURA'),
(4, 'puerta', 'EMPAQUE'),
(5, 'puerta', 'MANIJAS'),
(6, 'puerta', 'VISAGRAS'),
(7, 'chasis', 'LUCES'),
(8, 'chasis', 'PATAS'),
(9, 'chasis', 'FRENOS'),
(10, 'chasis', 'OTROS'),
(11, 'llantas', 'ADELANTE'),
(12, 'llantas', 'ATRAS'),
(13, 'marcham', 'ADELANTE'),
(14, 'marcham', 'ATRAS'),
(15, 'ext', 'SUCIO'),
(16, 'ext', 'MAL OLOR'),
(17, 'ext', 'RAYADURA'),
(18, 'ext', 'GOLPE'),
(19, 'ext', 'AGUJERO'),
(20, 'ext', 'MANCHAS'),
(21, 'ext', 'OXIDO'),
(22, 'int', 'GOLPE'),
(23, 'int', 'AGUJERO'),
(24, 'int', 'MANCHAS'),
(25, 'int', 'OXIDO'),
(26, 'puerta', 'BARRAS'),
(27, 'puerta', 'OTROS');

-- 
-- Dumping data for table desconexion
--
INSERT INTO desconexion VALUES
(1, '2021-04-09', '13:51', '66:39', 'prueba', 3, 3, 1, 'Activo', 1);

-- 
-- Dumping data for table contenedor_posicion_patio
--
-- Table sis_invcon.contenedor_posicion_patio does not contain any data (it is empty)

-- 
-- Dumping data for table conexion
--
INSERT INTO conexion VALUES
(1, '2021-04-06', '19:11:43', 3.10, 2.20, 2.10, 4, 1, 1, 'Activo', 'F', 'PP'),
(2, '2021-04-09', '15:20:40', 25.00, 12.00, 3.20, 3, 3, 1, 'Activo', 'F', 'EE');

-- 
-- Dumping data for table bitacora
--
INSERT INTO bitacora VALUES
(1, 'anular', '2021/05/03', '23:10:16', 'lcambran', 'Se anula TIR numero1', 'datostir'),
(2, 'Insertar', '2021/05/03', '23:25:47', '', 'Se Inserta TIR numero 2', 'datostir'),
(3, 'Insertar', '2021/05/03', '23:27:19', '', 'Se Inserta TIR numero 3', 'datostir'),
(4, 'Insertar', '2021/05/03', '23:30:01', 'Administrador', 'Se Inserta TIR numero 4', 'datostir'),
(5, 'anular', '2021/05/03', '23:33:01', 'lcambran', 'Se anula TIR numero 2', 'datostir'),
(6, 'anular', '2021/05/03', '23:33:09', 'lcambran', 'Se anula TIR numero 3', 'datostir'),
(7, 'Actualizar', '2021/05/05', '09:36:52', 'Administrador', 'Se Actualiza TIR numero 4', 'datostir'),
(8, 'Actualizar', '2021/05/05', '09:42:44', 'Administrador', 'Se Actualiza TIR numero 4', 'datostir'),
(9, 'Actualizar', '2021/05/05', '09:47:49', 'Administrador', 'Se Actualiza TIR numero 4', 'datostir'),
(10, 'Actualizar', '2021/05/05', '09:53:29', 'Administrador', 'Se Actualiza TIR numero 4', 'datostir'),
(11, 'Actualizar', '2021/05/05', '10:30:56', 'Administrador', 'Se Actualiza TIR numero 4', 'datostir'),
(12, 'Salida', '2021-05-06', '20:12:10', '1', 'Finalizacion de session', ''),
(13, 'Ingreso', '2021-05-06', '20:12:26', '1', 'Inicio de Sesion-Ingreso al sistema', ''),
(14, 'Salida', '2021-05-06', '20:13:09', 'Administrador', 'Finalizacion de session', ''),
(15, 'Ingreso', '2021-05-06', '20:13:14', 'Luis Cambran', 'Inicio de Sesion-Ingreso al sistema', ''),
(16, 'Salida', '2021-05-06', '20:33:48', 'Luis Cambran', 'Finalizacion de session', ''),
(17, 'Ingreso', '2021-05-06', '20:33:55', 'Administrador', 'Inicio de Sesion-Ingreso al sistema', ''),
(18, 'Ingreso', '2021-05-06', '21:03:57', 'Administrador', 'Inicio de Sesion-Ingreso al sistema', ''),
(19, 'Ingreso', '2021-05-06', '21:05:07', 'Administrador', 'Inicio de Sesion-Ingreso al sistema', ''),
(20, 'Ingreso', '2021-05-06', '16:19:35', 'Administrador', 'Inicio de Sesion-Ingreso al sistema', ''),
(21, 'Ingreso', '2021-05-07', '09:51:10', 'Administrador', 'Inicio de Sesion-Ingreso al sistema', ''),
(22, 'Ingreso', '2021-05-07', '11:37:14', 'Administrador', 'Inicio de Sesion-Ingreso al sistema', ''),
(23, 'Ingreso', '2021-05-07', '11:38:20', 'Administrador', 'Inicio de Sesion-Ingreso al sistema', ''),
(24, 'Ingreso', '2021-05-10', '09:48:05', 'Administrador', 'Inicio de Sesion-Ingreso al sistema', ''),
(25, 'Ingreso', '2021-05-10', '22:11:04', 'Administrador', 'Inicio de Sesion-Ingreso al sistema', ''),
(26, 'Insertar', '2021/05/10', '22:11:24', 'Administrador', 'Cierre de TIR No. ', 'datostir'),
(27, 'Insertar', '2021/05/10', '23:10:27', 'Administrador', 'Cierre de TIR No. ', 'datostir'),
(28, 'Insertar', '2021/05/10', '23:12:12', 'Administrador', 'Cierre de TIR No. ', 'datostir'),
(29, 'Insertar', '2021/05/10', '23:13:33', 'Administrador', 'Cierre de TIR No. 4', 'datostir'),
(30, 'Insertar', '2021/05/10', '23:16:34', 'Administrador', 'Cierre de TIR No. 4', 'datostir'),
(31, 'Insertar', '2021/05/10', '23:20:16', 'Administrador', 'Cierre de TIR No. 4', 'datostir'),
(32, 'Insertar', '2021/05/10', '23:22:02', 'Administrador', 'Cierre de TIR No. 4', 'datostir'),
(33, 'Insertar', '2021/05/10', '23:24:14', 'Administrador', 'Cierre de TIR No. 4', 'datostir'),
(34, 'Insertar', '2021/05/10', '23:26:53', 'Administrador', 'Cierre de TIR No. 4', 'datostir'),
(35, 'Insertar', '2021/05/10', '23:28:15', 'Administrador', 'Cierre de TIR No. 1', 'datostir'),
(36, 'Insertar', '2021/05/10', '23:28:56', 'Administrador', 'Cierre de TIR No. 4', 'datostir'),
(37, 'Ingreso', '2021-05-10', '23:36:38', 'Administrador', 'Inicio de Sesion-Ingreso al sistema', ''),
(38, 'Insertar', '2021/05/10', '23:37:51', 'Administrador', 'Cierre de TIR No. 1', 'datostir'),
(39, 'Insertar', '2021/05/10', '23:41:09', 'Administrador', 'Cierre de TIR No. 4', 'datostir'),
(40, 'Insertar', '2021/05/10', '23:45:40', 'Administrador', 'Cierre de TIR No. 4', 'datostir'),
(41, 'Ingreso', '2021-05-12', '20:08:47', 'Administrador', 'Inicio de Sesion-Ingreso al sistema', ''),
(42, 'Eliminacion', '', '', 'Administrador', 'Eliminacion de detalle no. 13', 'fallas_tir'),
(43, 'Actualizar', '2021/05/13', '01:03:35', 'Administrador', 'Se Actualiza TIR numero 1', 'datostir'),
(44, 'Eliminacion', '2021/05/13', '01:04:20', 'Administrador', 'Eliminacion de detalle no. 18', 'fallas_tir'),
(45, 'Actualizar', '2021/05/13', '01:06:15', 'Administrador', 'Se Actualiza TIR numero 1', 'datostir'),
(46, 'Eliminacion', '2021/05/13', '01:06:33', 'Administrador', 'Eliminacion de detalle no. 19', 'fallas_tir'),
(47, 'Actualizar', '2021/05/13', '01:09:47', 'Administrador', 'Se Actualiza TIR numero 1', 'datostir'),
(48, 'Eliminacion', '2021/05/13', '01:10:03', 'Administrador', 'Eliminacion de detalle no. 20', 'fallas_tir'),
(49, 'Eliminacion', '2021/05/13', '01:10:58', 'Administrador', 'Eliminacion de detalle no. 14', 'fallas_tir'),
(50, 'Eliminacion', '2021/05/13', '01:12:52', 'Administrador', 'Eliminacion de detalle no.  2', 'fallas_tir'),
(51, 'Actualizar', '2021/05/13', '01:16:15', 'Administrador', 'Se Actualiza TIR numero 1', 'datostir'),
(52, 'Eliminacion', '2021/05/13', '01:16:30', 'Administrador', 'Eliminacion de detalle no. 21', 'fallas_tir'),
(53, 'Actualizar', '2021/05/13', '01:19:31', 'Administrador', 'Se Actualiza TIR numero 1', 'datostir'),
(54, 'Eliminacion', '2021/05/13', '01:19:43', 'Administrador', 'Eliminacion de detalle no. 22', 'fallas_tir'),
(55, 'Actualizar', '2021/05/13', '01:22:06', 'Administrador', 'Se Actualiza TIR numero 1', 'datostir'),
(56, 'Eliminacion', '2021/05/13', '01:22:18', 'Administrador', 'Eliminacion de detalle no. 23', 'fallas_tir'),
(57, 'Ingreso', '2021-05-13', '19:43:53', 'Administrador', 'Inicio de Sesion-Ingreso al sistema', ''),
(58, 'Ingreso', '2021-05-13', '22:30:47', 'Administrador', 'Inicio de Sesion-Ingreso al sistema', ''),
(59, 'Ingreso', '2021-05-14', '14:52:08', 'Administrador', 'Inicio de Sesion-Ingreso al sistema', ''),
(60, 'Ingreso', '2021-05-14', '15:20:06', 'Administrador', 'Inicio de Sesion-Ingreso al sistema', ''),
(61, 'Insertar', '2021/05/14', '15:21:14', 'Administrador', 'Se Inserta TIR numero 26', 'datostir'),
(62, 'Eliminacion', '2021/05/14', '15:27:43', 'Administrador', 'Eliminacion de detalle no. 24', 'fallas_tir'),
(63, 'Actualizar', '2021/05/14', '15:28:25', 'Administrador', 'Se Actualiza TIR numero 26', 'datostir'),
(64, 'Salida', '2021-05-14', '15:47:00', 'Administrador', 'Finalizacion de session', ''),
(65, 'Ingreso', '2021-05-14', '15:54:59', 'Administrador', 'Inicio de Sesion-Ingreso al sistema', ''),
(66, 'Ingreso', '2021-05-16', '20:04:30', 'Administrador', 'Inicio de Sesion-Ingreso al sistema', ''),
(67, 'Ingreso', '2021-05-16', '20:34:48', 'Administrador', 'Inicio de Sesion-Ingreso al sistema', ''),
(68, 'Ingreso', '2021-05-16', '20:37:36', 'Administrador', 'Inicio de Sesion-Ingreso al sistema', ''),
(69, 'Ingreso', '2021-05-16', '20:39:27', 'Administrador', 'Inicio de Sesion-Ingreso al sistema', ''),
(70, 'Actualizar', '2021/05/16', '21:49:57', 'Administrador', 'Se Actualiza TIR numero 1', 'datostir'),
(71, 'Actualizar', '2021/05/16', '21:50:49', 'Administrador', 'Se Actualiza TIR numero 26', 'datostir');

-- 
-- Dumping data for table asignaciones
--
INSERT INTO asignaciones VALUES
(1, 'prueba actualizada', 2, 4, 1, 3, 1);

-- 
-- Dumping data for table altura_predio
--
-- Table sis_invcon.altura_predio does not contain any data (it is empty)

-- 
-- Restore previous SQL mode
-- 
/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;

-- 
-- Enable foreign keys
-- 
/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */;